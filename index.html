<!DOCTYPE HTML>
<html>
    <head>  <link rel="stylesheet" href="html5up-photon/assets/css/main.css" />
        <noscript>
            <link rel="stylesheet" href="html5up-photon/assets/css/noscript.css" />
        </noscript>
        <style>
            div.sticky {
              position: -webkit-sticky;
              position: sticky;
              bottom: 4px;
              padding: 5px;
              background-color: #fefeff;
              border: 2px solid #dee1f0;
            }
            table {
                border-collapse: collapse;
                width: 80%
                }

                td {
                border: 1px solid black;
                padding: 3px 5px;
                }
        </style>
    </head>
<body>
    
  <p>Before the script...</p>

  <script>
  "use strict";
    let currentUser = 0;
    let userArray = [];
    new User(0);

    //Create a character object, createCharacter function
    function User( index ) {
        if ( index != 0 ) currentUser += index;
        userArray[currentUser] = this;
        userArray[currentUser].name = "Link";
        //userArray[currentUser].name = prompt("Welcome to Kiojaklettr. Please enter your character's name now.","Link");
        userArray[currentUser].charClass = "Ranger";
        userArray[currentUser].money = Math.floor(Math.random() * 100 );
    };


    function rolldX() { 
            let sides = prompt("How many sides on this dice?",6);
            let result = Math.ceil(Math.random() * sides);
            document.getElementById("main_body").insertAdjacentHTML("afterend", 
                "<p>You roll a " + result + ".</p>"); 
        };

    function rollD6() {
        let result = Math.ceil(Math.random() * 6);
        document.getElementById("main_body").insertAdjacentHTML("afterend", 
                "<p>You roll a " + result + ".</p>"); 
    }

    function testRollD6() {
        let result = [0,0,0,0,0,0,0];
        for (let i=0; i<1000; i++)
        {
            let roll = Math.ceil(Math.random() * 6);
            if ( roll > 6 || roll < 1 ) alert(`Help, I somehow got a ${roll}`);
            result[roll]++;
        }

        let resultPercentages = [];
        result.forEach(function( item,index,result) {
            resultPercentages[index] = ( Math.round(( item / 1000 ) * 100)) + "%";
        });
            
        document.getElementById("main_body").insertAdjacentHTML("afterend", 
                "<p>Let's do some testing. We rolled 1000 times and got " + result + "<br> and also saw " + resultPercentages + "</p>"
                ); 
    }

    function newAction() {
        let actionOutput = document.getElementById("input_bar").value;
        document.getElementById("main_body").insertAdjacentHTML("afterend", 
            "<p>" + userArray[currentUser].name + " " + actionOutput + ".</p>"); 
        let _input_bar = document.getElementById("input_bar");
        _input_bar.value = "";
            
    }


    function showUserArray() {
        //userArray.forEach(alert( `Your characters: ${name}`));
        let charNames = userArray.map(character => ({
      name: `${character.name}`
    }))
        alert(charNames['name']);
    };  

    function onPaste(e) {
  if (!e.originalEvent.clipboardData ||
      !e.originalEvent.clipboardData.items) return;
  var items = e.originalEvent.clipboardData.items;
  var data;
  for (var i = 0; i < items.length; i++) {
    if (items[i].type == 'text/plain') {
      data = items[i];
      break;
    }
  }
  if (!data) return;
  data.getAsString(function(text) {
    text = text.replace(/\r/g, '').trim('\n');
    var rowsOfText = text.split('\n');
    var header = [];
    var rows = [];
    rowsOfText.forEach(function(rowAsText) {
      // Remove wrapping double quotes
      var row = rowAsText.split('\t').map(function(colAsText) {
        return colAsText.trim().replace(/^"(.*)"$/, '$1');
      });
      // The first row containing data is assumed to be the header
      if (header.length == 0) {
        // Remove empty columns
        while (row.length && !row[row.length-1].trim()) row.pop();
        if (row.length == 0) return;
        header = row;
      } else {
        rows.push(row.slice(0, header.length));
      }
    });
    buildTable(header, rows);
  });
}
$(document).on('paste', onPaste);

function buildTable(header, rows) {
  var $thead = $('table>thead').empty();
  var $tbody = $('table>tbody').empty();
  var $tr = $('<tr></tr>').appendTo($thead);
  header.forEach(function(value) {
    $tr.append('<th>' + value + '</th>');
  });
  rows.forEach(function(row) {
    var $tr = $('<tr></tr>').appendTo($tbody);
    row.forEach(function(value) {
      $tr.append('<td>' + value + '</td>');
    });
  });
}





    //Starting text
    document.body.innerHTML = "<p>Welcome! Please use the buttons below to roll a 6-sided or custom-sided dice." 

  </script>
  
  <p id="main_body"></p> 
  <p>
    <input id="bRollD6" type="button" value="Roll d6" onclick="rollD6()" />
    <input id="bRollDX" type="button" value="Roll dX" onclick="rolldX()" />

  </p>

</body>

</html>